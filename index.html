<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>LucrativeClix Coin Faucet</title>

<!-- Tailwind -->
<script src="https://cdn.tailwindcss.com"></script>

<!-- Ethers -->
<script src="https://cdn.jsdelivr.net/npm/ethers@6.8.3/dist/ethers.min.js"></script>

<!-- WalletConnect -->
<script type="module">
  import EthereumProvider from "https://unpkg.com/@walletconnect/ethereum-provider/dist/index.min.js";
  window.EthereumProvider = EthereumProvider;
</script>

<!-- reCAPTCHA -->
<script src="https://www.google.com/recaptcha/api.js" async defer></script>

<style>
body {
  background: radial-gradient(circle at 20% 20%, #6a00ff, transparent 40%),
              radial-gradient(circle at 80% 30%, #ff2fd1, transparent 45%),
              radial-gradient(circle at 50% 80%, #00e5ff, transparent 40%),
              #02010a;
  color: white;
  min-height: 100vh;
  overflow-x: hidden;
}
#stars { position: fixed; inset: 0; pointer-events: none; z-index: 0; }
.star { position: absolute; width: 2px; height: 2px; background: white; border-radius: 50%; opacity: .8; animation: twinkle 3s infinite; }
@keyframes twinkle { 0%,100%{opacity:.8} 50%{opacity:.2} }
.card {
  background: rgba(0,0,0,.65);
  backdrop-filter: blur(14px);
  border-radius: 24px;
}
.eclipse {
  position: relative;
  width: 120px;
  height: 120px;
}
.sun {
  position: absolute;
  inset: 0;
  background: radial-gradient(circle,#ffd700,#ff9800);
  border-radius: 50%;
}
.moon {
  position: absolute;
  inset: 0;
  background: #02010a;
  border-radius: 50%;
  animation: eclipse 2s linear infinite;
}
@keyframes eclipse {
  0% { transform: translateX(-120%); }
  100% { transform: translateX(120%); }
}
.glow {
  text-shadow: 0 0 15px #b300ff, 0 0 30px #ff2fd1;
}
</style>
</head>

<body>

<div id="stars"></div>

<header class="text-center py-14 relative z-10">
  <h1 class="text-5xl font-extrabold glow">ðŸŒŒ LucrativeClix Coin</h1>
  <p class="mt-3 text-gray-200">Official LCC Faucet â€¢ Sepolia Testnet</p>
</header>

<main class="flex justify-center px-4 relative z-10">
  <div class="card p-8 max-w-lg w-full shadow-2xl">

    <div id="walletInfo" class="text-sm text-center mb-4 text-gray-300">
      ðŸ”Œ Wallet not connected
    </div>

    <button id="mmBtn" class="w-full bg-purple-600 py-3 rounded-xl font-bold mb-3 hover:scale-105 transition">
      ðŸ¦Š Connect MetaMask
    </button>

    <button id="wcBtn" class="w-full bg-indigo-600 py-3 rounded-xl font-bold mb-4 hover:scale-105 transition">
      ðŸ”— WalletConnect
    </button>

    <div class="mb-4">
      <div class="g-recaptcha" data-sitekey="6LeleSosAAAAAFrgl4nMa85sOOcJN0EM8P15JfQp"></div>
    </div>

    <button id="claimBtn" disabled class="w-full bg-pink-500 py-3 rounded-xl font-bold opacity-50 cursor-not-allowed">
      ðŸš€ Claim 0.1 LCC
    </button>

    <p id="status" class="mt-4 text-center text-sm"></p>

    <div id="loader" class="hidden mt-6 flex flex-col items-center">
      <div class="eclipse">
        <div class="sun"></div>
        <div class="moon"></div>
      </div>
      <p id="progress" class="mt-3 text-sm">0%</p>
    </div>

    <div id="success" class="hidden mt-6 text-center text-2xl glow">
      âœ¨ LCC Sent Successfully âœ¨
    </div>

  </div>
</main>

<footer class="text-center py-10 text-gray-400 relative z-10">
  Â© 2025 LucrativeClix Coin
</footer>

<script>
/* STARFIELD */
const stars = document.getElementById("stars");
for (let i = 0; i < 180; i++) {
  const s = document.createElement("div");
  s.className = "star";
  s.style.top = Math.random() * 100 + "%";
  s.style.left = Math.random() * 100 + "%";
  s.style.animationDelay = Math.random() * 3 + "s";
  stars.appendChild(s);
}

/* GLOBAL STATE */
let provider, signer, userAddress;
const walletInfo = document.getElementById("walletInfo");
const claimBtn = document.getElementById("claimBtn");
const statusEl = document.getElementById("status");
const loader = document.getElementById("loader");
const progress = document.getElementById("progress");
const success = document.getElementById("success");

/* NETWORK */
const SEPOLIA_ID = "0xaa36a7";

/* CONNECT METAMASK */
async function connectMetaMask() {
  if (!window.ethereum) return statusEl.textContent = "âŒ MetaMask not found";
  provider = new ethers.BrowserProvider(window.ethereum);
  await provider.send("eth_requestAccounts", []);
  await window.ethereum.request({
    method: "wallet_switchEthereumChain",
    params: [{ chainId: SEPOLIA_ID }]
  });
  signer = await provider.getSigner();
  userAddress = await signer.getAddress();
  walletInfo.textContent = "âœ… Connected: " + userAddress;
  enableClaim();
}

/* WALLETCONNECT */
async function connectWalletConnect() {
  const wc = await window.EthereumProvider.init({
    projectId: "6e7e3a7f736b30fcd2d054bdfbe17bc6",
    chains: [11155111],
    showQrModal: true
  });
  await wc.enable();
  provider = new ethers.BrowserProvider(wc);
  signer = await provider.getSigner();
  userAddress = await signer.getAddress();
  walletInfo.textContent = "âœ… Connected: " + userAddress;
  enableClaim();
}

function enableClaim() {
  claimBtn.disabled = false;
  claimBtn.classList.remove("opacity-50","cursor-not-allowed");
}

/* CLAIM */
async function claim() {
  if (!grecaptcha.getResponse()) {
    return statusEl.textContent = "âš ï¸ Complete reCAPTCHA";
  }

  loader.classList.remove("hidden");
  let p = 0;
  const timer = setInterval(() => {
    p++;
    progress.textContent = p + "%";
    if (p >= 100) clearInterval(timer);
  }, 20);

  await fetch("/api/claim", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ wallet: userAddress })
  });

  loader.classList.add("hidden");
  success.classList.remove("hidden");
  statusEl.textContent = "ðŸŽ‰ Faucet completed";
}

/* EVENTS */
document.getElementById("mmBtn").onclick = connectMetaMask;
document.getElementById("wcBtn").onclick = connectWalletConnect;
document.getElementById("claimBtn").onclick = claim;
</script>

</body>
  </html>
