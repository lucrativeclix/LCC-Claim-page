<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>LucrativeClix Coin (LCC) Faucet</title>

<!-- Tailwind CSS -->
<script src="https://cdn.tailwindcss.com"></script>

<!-- Ethers.js v6 -->
<script src="https://cdn.jsdelivr.net/npm/ethers@6.16.0/dist/ethers.min.js"></script>

<!-- WalletConnect v2 -->
<script type="module">
import EthereumProvider from "https://unpkg.com/@walletconnect/ethereum-provider/dist/index.min.js";
window.EthereumProvider = EthereumProvider;
</script>

<!-- Google reCAPTCHA -->
<script src="https://www.google.com/recaptcha/api.js" async defer></script>

<style>
/* =========================
   GLOBAL STYLES
========================= */
html, body {
  margin: 0;
  padding: 0;
  font-family: 'Poppins', sans-serif;
  min-height: 100vh;
  background:
    radial-gradient(circle at 20% 20%, #6a00ff, transparent 40%),
    radial-gradient(circle at 80% 30%, #ff2fd1, transparent 45%),
    radial-gradient(circle at 50% 80%, #00e5ff, transparent 40%),
    #02010a;
  color: white;
  overflow-x: hidden;
}

/* =========================
   STARFIELD
========================= */
#stars {
  position: fixed;
  inset: 0;
  z-index: 0;
  pointer-events: none;
}

.star {
  position: absolute;
  width: 2px;
  height: 2px;
  background: white;
  border-radius: 50%;
  opacity: .8;
  animation: twinkle 3s infinite;
}

@keyframes twinkle {
  0%,100% { opacity:.8 }
  50% { opacity:.2 }
}

/* =========================
   UI COMPONENTS
========================= */
.card {
  background: rgba(0,0,0,.65);
  backdrop-filter: blur(14px);
  border-radius: 24px;
  padding: 2rem;
}

.glow {
  text-shadow: 0 0 15px #b300ff, 0 0 30px #ff2fd1;
}

button {
  transition: all 0.3s ease;
}
button:hover {
  transform: scale(1.05);
}

/* =========================
   POPUPS & LOADER
========================= */
.popup {
  position: fixed;
  top:50%;
  left:50%;
  transform:translate(-50%,-50%);
  background: rgba(0,0,0,.95);
  backdrop-filter: blur(16px);
  border-radius: 24px;
  padding: 2rem;
  z-index:50;
  display:none;
}

.popup.show {
  display:block;
}

.eclipse {
  position: relative;
  width: 120px;
  height: 120px;
}

.sun {
  position: absolute;
  inset:0;
  background: radial-gradient(circle,#ffd700,#ff9800);
  border-radius:50%;
}

.moon {
  position: absolute;
  inset:0;
  background:#02010a;
  border-radius:50%;
  animation:eclipseMove 2s linear infinite;
}

@keyframes eclipseMove {
  0% { transform: translateX(-120%); }
  100% { transform: translateX(120%); }
}
</style>
</head>
<body>

<!-- STARFIELD -->
<div id="stars"></div>

<!-- HEADER -->
<header class="text-center py-16 relative z-10">
  <h1 class="text-5xl font-extrabold glow">ðŸŒŒ LucrativeClix Coin</h1>
  <p class="mt-4 text-lg text-gray-200">Official LCC Faucet â€¢ Sepolia Testnet</p>
  <p class="mt-2 text-gray-400">Claim 0.1 LCC every 12 hours</p>
</header>

<!-- MAIN CARD -->
<main class="flex justify-center px-4 relative z-10">
  <div class="card max-w-lg w-full shadow-2xl">

    <!-- CONNECT BUTTON -->
    <button id="connectBtn" class="w-full bg-purple-600 py-3 rounded-xl font-bold mb-3">
      ðŸ”— Connect Wallet
    </button>

    <p id="walletStatus" class="text-sm text-center text-gray-300 mb-4">
      Wallet not connected
    </p>

    <p class="text-xs text-center text-gray-400 mb-4">
      Mobile users will be redirected to MetaMask or WalletConnect
    </p>

    <!-- CAPTCHA -->
    <div class="mb-4">
      <div class="g-recaptcha" data-sitekey="6LeleSosAAAAAFrgl4nMa85sOOcJN0EM8P15JfQp"></div>
    </div>

    <!-- CLAIM BUTTON -->
    <button id="claimBtn"
      disabled
      class="w-full bg-pink-500 py-3 rounded-xl font-bold opacity-50 cursor-not-allowed">
      ðŸš€ Claim 0.1 LCC
    </button>

    <p id="balance" class="mt-4 text-center text-green-400">
      Balance: -
    </p>

    <p id="status" class="mt-3 text-center text-sm"></p>

    <!-- LOADER -->
    <div id="loader" class="hidden mt-6 flex flex-col items-center">
      <div class="eclipse">
        <div class="sun"></div>
        <div class="moon"></div>
      </div>
      <p id="progress" class="mt-3 text-sm">0%</p>
    </div>

    <!-- SUCCESS MESSAGE -->
    <div id="success" class="hidden mt-6 text-center text-2xl glow">
      âœ¨ LCC Sent Successfully âœ¨
    </div>

  </div>
</main>

<footer class="text-center py-12 text-gray-400 relative z-10">
  Â© 2025 LucrativeClix Coin
</footer>

<script>
/* =========================
   STARFIELD INIT
========================= */
const stars = document.getElementById("stars");
for (let i=0;i<300;i++){
  const s=document.createElement("div");
  s.className="star";
  s.style.top=Math.random()*100+"%";
  s.style.left=Math.random()*100+"%";
  s.style.animationDelay=Math.random()*3+"s";
  stars.appendChild(s);
}

/* =========================
   CONFIG
========================= */
const CHAIN_ID = 11155111; // Sepolia
const CHAIN_HEX = "0xaa36a7";
const WC_PROJECT_ID = "6e7e3a7f736b30fcd2d054bdfbe17bc6";
const LCC_TOKEN = "0x873612265e161c3857d9223B1BA06Eb98D9dE65a";

/* =========================
   GLOBAL STATE
========================= */
let provider = null;
let signer = null;
let userAddress = null;
let wcProvider = null;

/* =========================
   HELPER FUNCTIONS
========================= */
function isMobile() {
  return /Android|iPhone|iPad|iPod/i.test(navigator.userAgent);
}

/* =========================
   UPDATE UI AFTER CONNECT
========================= */
function updateUIConnected() {
  const btn = document.getElementById("connectBtn");
  const status = document.getElementById("walletStatus");

  btn.textContent = "âœ… Wallet Connected";
  btn.disabled = true;
  btn.classList.add("opacity-60", "cursor-not-allowed");

  status.textContent =
    "Connected: " + userAddress.slice(0, 6) + "..." + userAddress.slice(-4);

  enableClaim();
  updateBalance();
}

/* =========================
   ENABLE CLAIM
========================= */
function enableClaim() {
  const btn = document.getElementById("claimBtn");
  btn.disabled = false;
  btn.classList.remove("opacity-50","cursor-not-allowed");
}

/* =========================
   CONNECT WALLET FUNCTION
========================= */
async function connectMetaMask() {
  if (!window.ethereum) {
    alert("MetaMask not detected");
    return;
  }

  provider = new ethers.BrowserProvider(window.ethereum);

  try {
    await provider.send("eth_requestAccounts", []);
    signer = await provider.getSigner();
    userAddress = await signer.getAddress();

    localStorage.setItem("lcc_connected", "true");

    updateUIConnected();
  } catch (err) {
    console.error(err);
    document.getElementById("walletStatus").textContent = "âŒ Connection failed";
  }
}

/* =========================
   CONNECT BUTTON EVENT
========================= */
document.getElementById("connectBtn").onclick = async () => {
  if (window.ethereum && !isMobile()) {
    await connectMetaMask();
  } else if (isMobile()) {
    const dapp = window.location.href.replace(/^https?:\/\//,"");
    window.location.href = `https://metamask.app.link/dapp/${dapp}`;
  } else {
    // fallback WalletConnect
    try {
      wcProvider = await EthereumProvider.init({
        projectId: WC_PROJECT_ID,
        chains: [CHAIN_ID],
        showQrModal: true
      });
      await wcProvider.enable();
      provider = new ethers.BrowserProvider(wcProvider);
      signer = await provider.getSigner();
      userAddress = await signer.getAddress();
      updateUIConnected();
    } catch(err){
      document.getElementById("walletStatus").textContent="âŒ Wallet not detected";
    }
  }
};

/* =========================
   AUTO RECONNECT ON LOAD
========================= */
window.addEventListener("load", async () => {
  if (window.ethereum && localStorage.getItem("lcc_connected")) {
    provider = new ethers.BrowserProvider(window.ethereum);
    signer = await provider.getSigner();
    userAddress = await signer.getAddress();
    updateUIConnected();
  }
});

/* =========================
   HANDLE ACCOUNT & NETWORK CHANGES
========================= */
if(window.ethereum){
  window.ethereum.on("accountsChanged", async (accounts) => {
    if(accounts.length===0){
      localStorage.removeItem("lcc_connected");
      location.reload();
    } else {
      userAddress = accounts[0];
      updateUIConnected();
    }
  });

  window.ethereum.on("chainChanged", () => {
    location.reload();
  });
}

/* =========================
   UPDATE BALANCE
========================= */
async function updateBalance(){
  try {
    const abi=[
      "function balanceOf(address) view returns(uint256)",
      "function decimals() view returns(uint8)"
    ];
    const token = new ethers.Contract(LCC_TOKEN, abi, provider);
    const bal = await token.balanceOf(userAddress);
    const dec = await token.decimals();
    document.getElementById("balance").textContent = "Balance: " + (Number(bal)/10**dec).toFixed(4) + " LCC";
  } catch(e){
    document.getElementById("balance").textContent = "Balance: -";
  }
}

/* =========================
   CLAIM BUTTON FUNCTION
========================= */
document.getElementById("claimBtn").onclick = async () => {
  if (!grecaptcha.getResponse()) {
    document.getElementById("status").textContent="âš ï¸ Complete reCAPTCHA";
    return;
  }

  document.getElementById("status").textContent="â›“ï¸ Sending request...";
  startLoader();

  // Simulate backend call
  setTimeout(()=>{
    stopLoader();
    document.getElementById("success").classList.remove("hidden");
    document.getElementById("status").textContent="ðŸŽ‰ Faucet completed";
    grecaptcha.reset();
    updateBalance();
  },4000);
};

/* =========================
   LOADER FUNCTIONS
========================= */
function startLoader(){
  document.getElementById("loader").classList.remove("hidden");
  let p=0;
  const i = setInterval(()=>{
    p++;
    document.getElementById("progress").textContent = p+"%";
    if(p>=100) clearInterval(i);
  },30);
}

function stopLoader(){
  document.getElementById("loader").classList.add("hidden");
  document.getElementById("progress").textContent="0%";
}
</script>

</body>
                                                                    </html>
